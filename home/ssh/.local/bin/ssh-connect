#!/usr/bin/zsh
drop_in_configs=$(ls $XDG_CONFIG_HOME/ssh/ssh.d/**/*.sshconfig)
ssh_hosts_list=$(
  awk '/Host\s/ {print $2}' <(cat ${HOME}/.ssh/config "${drop_in_configs}")
)
selected_host=$(
  bemenu --prompt 'Connect to SSH' \
    --fn 'Ubuntu Mono 14' \
    --list 10 \
    --ignorecase \
    <<< "${ssh_hosts_list}"
)

if [[ -z "${selected_host}" ]]; then
  echo "not selected"
  exit 0
fi

notify-send "Connecting to ${selected_host} via SSH" \
  --expire-time 2000

kitty ssh "${selected_host}"

